{% extends 'base.html'%}
{% load staticfiles %}
{% block content %}
<div class="callout">
    <div class="container-fluid my-container-padding">
    <!-- Carousel is used to display welcome message, has 3 slides that rotate for the user to see different features of the site -->
        <div id="carouselExampleCaptions" data-interval="100000" class="carousel slide carousel-background" data-ride="carousel">
            <ol class="carousel-indicators">
                <li data-target="#carouselExampleCaptions" data-slide-to="0" class="active"></li>
                <li data-target="#carouselExampleCaptions" data-slide-to="1"></li>
                <li data-target="#carouselExampleCaptions" data-slide-to="2"></li>
            </ol>
            <div class="carousel-inner">
                <div class="carousel-item active">
                <!-- If the user is authenticated then a different message shows on the home screen -->
                {% if user.is_authenticated %}
                    <div class="carousel-text my-loggedin-carousel-item">
                        <div class="row">
                            <div class="col-12">
                                <p class="kristi-font">Hey There</p>
                            </div>
                            <div class="col">
                                <h3 class="didact-gothic-font text-center loggedin-intro-font-size-space">Browse all Succulants and Herbal Teas below</h3>
                            </div>
                        </div>
                    </div>
                {% else %}
                    <div class="carousel-text my-carousel-item">
                        <div class="row">
                            <div class="col-12">
                                <p class="kristi-font">Welcome</p>
                            </div>   
                            <div class="col">
                                <h3 class="didact-gothic-font text-center intro-font-size-space d-none d-sm-block">Andrea's Haberdashery is here for the wayward travelor's soul. Each product is handcrafted and homegrown with a passion for the naturalistic lifestyle.</h3>
                            </div>
                            <div class="col-12">
                                <h3 class="didact-gothic-font text-center intro-font-size-space d-block d-sm-none">to Andrea's Haberdashery</h3>
                            </div>
                        </div>
                        <div class="row justify-content-end">
                            <div class="col-4 my-btn-center">
                            <!-- triggers login function to take user to login page -->
                                <a href="{% url 'login' %}" class="nav-link" data-toggle="tooltip" data-placement="bottom" title="Sign In">
                                    <button type="button" class="btn btn-outline-dark button-login-color arimo-font">Login</button>  
                                </a>
                            </div>
                            <div class="col-4 my-btn-center">
                            <!-- triggers registration function to take user to registration page -->
                                <a href="{% url 'registration' %}" class="nav-link" data-toggle="tooltip" data-placement="bottom" title="Sign In">
                                    <button type="button" class="btn btn-dark button-register-color arimo-font">Register</button>  
                                </a>
                            </div>
                        </div>
                    </div>
                    {% endif %}
                </div>
                <div class="carousel-item my-second-carousel-item text-center">
                <!-- Second carousel item is set into 3 different versions of the same div to accomodate different screen sizes -->
                <!-- Hidden only on small screensizes -->
                    <div class="carousel-text d-sm-none d-md-block d-none">
                        <div class="row justify-content-end">
                            <div class="col-4 my-card-spacing">
                                <div class="card card-background" style="width: 18rem;">
                                    <img src="{% static 'images/handplant.jpg' %}" class="card-img-top card-image-sizing-spacing" alt="Shop Succulents">
                                    <div class="card-body">
                                        <h4 class="card-title didact-gothic-font d-sm-none d-md-block">Succulents</h4>
                                        <p class="card-text arimo-font d-sm-none d-md-block">Our succulents are planted and grown right in our backyard, curated by our gardeners who spents years perfecting their craft. </p>
                                        <!-- Form is used here instead of creating categories in database, searches for specific value shown below -->
                                        <form class="width-removal" action="{% url 'search' %}" method="get">
                                            <input type="text" class="form-control d-none" value="Succulent" name="q">
                                            <a href="#shop"><button class="btn button-register-color arimo-font" type="search">Shop Succulents</button></a>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            <div class="col-4 my-card-spacing">
                                <div class="card card-background" style="width: 18rem;">
                                    <img src="{% static 'images/herbalhand.jpg' %}" class="card-img-top card-image-sizing-spacing" alt="Shop Succulents">
                                    <div class="card-body">
                                        <h4 class="card-title didact-gothic-font d-sm-none d-md-block">Herbal Teas</h4>
                                        <p class="card-text arimo-font d-sm-none d-md-block">Our all natural and holistic teas have been handcrafted from homegrown herbs and spices for a natural healing experience. </p>
                                        <!-- Form is used here instead of creating categories in database, searches for specific value shown below -->
                                        <form class="width-removal" action="{% url 'search' %}" method="get">
                                            <input type="text" class="form-control d-none" value="Tea" name="q">
                                            <button class="btn button-register-color arimo-font" type="search">Shop Herbal</button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Visible only on Small screensizes, Hidden only on Xtra Small screen sizes -->
                    <div class="carousel-text d-none d-sm-block d-md-none d-none d-sm-block">
                        <div class="row justify-content-start">
                            <div class="col-4 my-card-spacing">
                                <div class="card card-background" style="width: 18rem;">
                                    <img src="{% static 'images/handplant.jpg' %}" class="card-img-top card-image-sizing-spacing" alt="Shop Succulents">
                                    <div class="card-body">
                                        <h4 class="card-title didact-gothic-font d-sm-none d-md-block">Succulents</h4>
                                        <p class="card-text arimo-font d-sm-none d-md-block">Our succulents are planted and grown right in our backyard, curated by our gardeners who spents years perfecting their craft. </p>
                                        <!-- Form is used here instead of creating categories in database, searches for specific value shown below -->
                                        <form class="width-removal" action="{% url 'search' %}" method="get">
                                            <input type="text" class="form-control d-none" value="Succulents" name="q">
                                            <button class="btn button-register-color arimo-font" type="search">Shop Succulents</button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            <div class="col-4 my-card-spacing">
                                <div class="card card-background" style="width: 18rem;">
                                    <img src="{% static 'images/herbalhand.jpg' %}" class="card-img-top card-image-sizing-spacing" alt="Shop Succulents">
                                    <div class="card-body">
                                        <h4 class="card-title didact-gothic-font d-sm-none d-md-block">Herbal Teas</h4>
                                        <p class="card-text arimo-font d-sm-none d-md-block">Our all natural and holistic teas have been handcrafted from homegrown herbs and spices for a natural healing experience. </p>
                                        <!-- Form is used here instead of creating categories in database, searches for specific value shown below -->
                                        <form class="width-removal" action="{% url 'search' %}" method="get">
                                            <input type="text" class="form-control d-none" value="Tea" name="q">
                                            <button class="btn button-register-color arimo-font" type="search">Shop Herbal</button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Visible only on Xtra Small screen sizes -->
                    <div class="carousel-text d-none d-md-none d-block d-sm-none d-lg-none">
                        <div class="row justify-content-start">
                            <div class="col-12 box-flower-card-spacing">
                                <div class="card card-background" style="width: 18rem;">
                                    <img src="{% static 'images/flowerbox.jpg' %}" class="card-img-top box-flower-sizing-spacing" alt="Shop Succulents">
                                    <div class="card-body">
                                    <a href="#shop" class="btn button-register-color arimo-font">Shop Now</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 3rd Carousel item gives free shipping info, 
            2 divs that contain carousel-text are different versions of the same div. 
            The differing class names adjust the font sizes -->
            <div class="carousel-item my-carousel-item">
                <div class="carousel-text d-none d-sm-block">
                    <p class="kristi-font-shipping">Free Shipping</p>
                    <h4>Now through August 2020, Free Shipping anywhere!</h4>
                </div>
                <div class="carousel-text d-block d-sm-none">
                    <h1 class="kristi-font-unset-size">Free Shipping</h1>
                    <h5>Now through August 2020, Free Shipping anywhere!</h5>
                </div>
            </div>
        </div>
        <a class="carousel-control-prev" href="#carouselExampleCaptions" role="button" data-slide="prev">
            <span class="prev-arrow-spacing" aria-hidden="true"><i class="carousel-icon-color fas fa-chevron-left"></i></span>
            <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carouselExampleCaptions" role="button" data-slide="next">
            <span class="next-arrow-spacing" aria-hidden="true"><i class="carousel-icon-color fas fa-chevron-right"></i></span>
            <span class="sr-only">Next</span>
        </a>

    </div>
</div>

<div class="row row flex">
<!-- IF statement checks if amount of 
products shown are more than 0. 
This ensures that when there is a search, 
the user will be shown a message stating that 
nothing matched their search  -->
{% if products|length > 0 %}
<!-- For Loop iterates through the products in the database, gives products names, descriptions, price, product images -->
    {% for product in products %}
    <div class="col-xs-10 col-xs-offset-1 col-sm-offset-0 col-sm-6 col-md-4 display panel panel-default" id="shop">
        <div class="panel-body">
            <div class="product product-image" style="background-image: url('{{ MEDIA_URL }}{{ product.image }}">
            </div>
            <h3>{{ product.name }}</h3>
            <p class="product-description">{{ product.description|truncatewords:20 }} </p>
            <p><i class="fas fa-euro-sign"></i> {{ product.price }}</p>
            <!-- triggers add_to_cart function to add products to cart -->
            <form method="POST" id="quantity" action="{% url 'add_to_cart' product.id %}">
                {% csrf_token %}
                <div class="input-group">
				    <input type="number" value="1" aria-label="Search" min="1" max="999" class="form-control"  name="quantity" style="display:none">
					<button class="btn btn-outline-dark button-login-color arimo-font" type="submit">Add to cart</button>
                    <button type="button" class="btn adjust-item-button button-login-color arimo-font" data-toggle="modal" data-target="#exampleModalScrollable{{ product.id }}">View Details</button>
                </div>
            </form>
        </div>
    </div>

<!-- Modal -->
<!-- shows product details in the all products view -->
    <div class="modal fade" id="exampleModalScrollable{{ product.id }}" tabindex="-1" role="dialog" aria-labelledby="exampleModalScrollableTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalScrollableTitle">{{ product.name }}</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="panel-body">
                        <div class="product product-image" style="background-image: url('{{ MEDIA_URL }}{{ product.image }}">
                        </div>
                        <p class="product-description">{{ product.description }} </p>
                        <p><i class="fas fa-euro-sign"></i> {{ product.price }}</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
		            <form method="POST" id="quantity" action="{% url 'add_to_cart' product.id %}">
                        {% csrf_token %}
                        <div class="input-group">
				            <input type="number" value="1" aria-label="Search" min="1" max="999" class="form-control"  name="quantity" style="display:none">
					        <button class="btn btn-outline-dark button-login-color arimo-font" type="submit">Add to cart</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>  
    </div>
{% endfor %}
{% else %}
    <div class="col">
        <h1>0 Results</h1>
        <h2>Oh no, we can't find any products that match your search</h2>
    </div> 
{% endif %}
</div>
{% endblock %}